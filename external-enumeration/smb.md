# SMB (139, 445)

### Enumerate Protocols
`nmap -p139,445 --script smb-protocols $TARGET_IP`

### Enumerate OS Version
`nmap -p139,445 --script smb-os-discovery $TARGET_IP`

### Enumerate Shares
* `nmap -p139,445 --script smb-enum-shares $TARGET_IP`
* `smbmap -H $TARGET_IP`

### Enumerate Users
`nmap -p139,445 --script smb-enum-users $TARGET_IP`

### Login Brute Force
`hydra -L /usr/share/seclists/Usernames/list.txt -P /usr/share/seclists/Passwords/list.txt $TARGET_IP smb`

### Check Vulnerabilities
`nmap --script smb-vuln-* -p 139,445 $TARGET_IP`

### Automatic enumeration
`enum4linux -a $TARGET_IP`

### Anonymous access
`smbclient //$IP/share-name --no-pass`

### Notes
Eternal-red/CVE-2017-7494 is an easy way to get a root shell on a vulnerable system and isn't always detected by nmaps `smb-vuln-cve-2017-7494` script.
In order for a system to be vulnerable it needs to be running a vulnerable version of samba (3.5.0-4.5.4/4.5.10/4.4.14) on port 445, and have write privileges
on a share.

