# Post-Exploitation Enumeration

## Enumerating Users

### Windows
* `whoami`
* `net user <username>`

### Linux
* `whoami`
* `id`
* `cat /etc/passwd`

## Enumerating the Hostname

### Windows/Linux
* `hostname`

## Enumerating the Operating System

### Windows
* `systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type`

### Linux
* `cat /etc/issue`
* `cat /etc/*-release`
* `uname -a`

## Enumerating Running Processes and Services

### Windows
* `tasklist /SVC`

### Linux
* `ps aux`

## Enumerating Networking Information

### Windows
* `ipconfig /all`
* `route print`
* `netstat -ano`

### Linux
* `/sbin/route`
* `ss -anp`

## Enumerating Firewall Status and Rules

### Windows
* `netsh advfirewall show currentprofile`
* `netsh advfirewall firewall show rule name=all`

### Linux
* `cat /etc/iptables`

## Enumerating Scheduled Tasks

### Windows
* `schtasks /query /fo LIST /v`

### Linux
* `ls -lah /etc/cron*`
* `cat /etc/crontab`

## Enumerating Installed Applications

### Windows
* `wmic product get name, version, vendor`
* `wmic qfe get Caption, Description, HotFixID, InstalledOn`

### Linux
* `dpkg -l` (Debian)

## Enumerating Readable/Writable Files and Directories

### Windows
* `Get-ChildItem "C:\Program Files" -Recurse | Get-ACL | ?{$_.AccessToString -match "Everyone\sAllow\s\sModify"}`

### Linux
* `find / -writable -type d 2>/dev/null`

## Enumerating Unmounted Disks

### Windows
* `mountvol`

### Linux
* `cat /etc/fstab`
* `mount`
* `/bin/lsblk`

## Enumerating Device Drivers and Kernel Modules

### Windows
* `PS> driverquery.exe /v /fo csv | ConvertFrom-CSV | Select-Object 'Display Name', 'Start Mode', Path`

### Linux
* `lsmod`
* `/sbin/modinfo <modulename>`

## Enumerating Binaries that Auto-Elevate

### Windows
First run `reg_query`. Then:

* `HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer`
* `HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer`

### Linux
* `find / -perm -u=s -type f 2>/dev/null`

## Automated Enumeration

* [linux-smart-enumeration](https://github.com/diego-treitos/linux-smart-enumeration)
* [linpeas](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS)
* [linux-private-i](https://github.com/rtcrowley/linux-private-i)

